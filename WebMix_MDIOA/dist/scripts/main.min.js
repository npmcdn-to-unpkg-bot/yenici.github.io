"use strict";function toggleClass(e,t){t=t.trim(),e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}function getMsMenu(){return[{name:"Store",link:"javascript:void(0)",children:[{name:"Store home",link:"http://www.microsoftstore.com/store/msusa/en_US/home",children:[]},{name:"Device",link:"javascript:void(0)",children:[{name:"Microsoft Surface",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-Surface/categoryID.69403400"},{name:"PCs &amp; tablets",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-PCs-tablets/categoryID.69404700"},{name:"Xbox",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/categoryID.69405400"},{name:"Virtual reality",link:"https://www.microsoftstore.com/store/msusa/en_US/cat/Virtual-and-Augmented-Reality/categoryID.594470000?icid=en_US_Store_UH_devices_vr"},{name:"Accessories",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-accessories/categoryID.69407900"},{name:"Windows phone",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-Windows-Phone/categoryID.69406200"},{name:"Microsoft Band",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/categoryID.69889600"}]},{name:"Software",link:"javascript:void(0)",children:[{name:"Office",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-Office/categoryID.69403900"},{name:"Windows",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/categoryID.70036700"},{name:"Additional software",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/All-additional-software/categoryID.69407400"}]},{name:"Apps",link:"javascript:void(0)",children:[{name:"All apps",link:"https://www.microsoft.com/en-us/store/apps"},{name:"Windows apps",link:"https://www.microsoft.com/en-us/store/apps/windows"},{name:"Windows phone apps",link:"https://www.microsoft.com/en-us/store/apps/windows-phone"}]},{name:"Games",link:"javascript:void(0)",children:[{name:"Xbox One games",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Xbox-One-games/categoryID.69405600"},{name:"Xbox 360 games",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Xbox-360-games/categoryID.69405800"},{name:"PC games",link:"http://www.microsoftstore.com/store/msusa/en_US/list/PC-games/categoryID.62688000?icid=en_US_Store_UH_games_PC"},{name:"Windows games",link:"https://www.microsoft.com/en-us/store/games/windows"},{name:"Windows phone games",link:"https://www.microsoft.com/en-us/store/games/windows-phone"}]},{name:"Entertainment",link:"javascript:void(0)",children:[{name:"All Entertainment",link:"https://www.microsoft.com/en-us/store/entertainment"},{name:"Movies &amp; TV",link:"https://www.microsoft.com/en-us/store/movies-and-tv"},{name:"Music",link:"https://www.microsoft.com/en-us/store/music"}]},{name:"Business &amp; Education",link:"javascript:void(0)",children:[{name:"Business Store",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Business/categoryID.69408700"},{name:"Education Store",link:"http://www.microsoftstore.com/store/msusa/en_US/edu"},{name:"Developer",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Developer/categoryID.69418300?icid=en_US_Store_UH_BusEd_Dev"}]},{name:"Sale",link:"javascript:void(0)",children:[{name:"Back-to-school essentials",link:"https://www.microsoftstore.com/store/msusa/en_US/cat/Back-to-school-essentials/categoryID.67998200?icid=en_US_Store_UH_sale_gm_bts",children:[]},{name:"Sale",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Sale/categoryID.69403000"}]},{name:"Find a store",link:"http://www.microsoft.com/en-us/store/locations/find-a-store?icid=L_navAB_FindAStore",children:[]},{name:"Gift cards",link:"https://www.microsoft.com/en-us/store/gift-cards",children:[]}]},{name:"Products",link:"javascript:void(0)",children:[{name:"Software &amp; services",link:"javascript:void(0)",children:[{name:"Windows",link:"//www.microsoft.com/en-us/windows"},{name:"Office",link:"https://products.office.com/en-us/home"},{name:"Free downloads &amp; security",link:"https://www.microsoft.com/en-us/download/default.aspx"},{name:"Internet Explorer",link:"http://windows.microsoft.com/en-us/internet-explorer/download-ie"},{name:"Microsoft Edge",link:"http://www.microsoft.com/en-us/windows/microsoft-edge"},{name:"Skype",link:"http://www.skype.com/en/"},{name:"OneNote",link:"http://www.onenote.com/"},{name:"OneDrive",link:"https://onedrive.live.com/about/en-us/"},{name:"Microsoft Health",link:"http://www.microsoft.com/microsoft-health/en-us"},{name:"MSN",link:"http://www.msn.com/?ocid=HEA000"},{name:"Bing",link:"http://www.bing.com"},{name:"Microsoft Groove",link:"https://www.microsoft.com/en-us/groove"},{name:"Microsoft Movies &amp; TV",link:"https://www.microsoft.com/en-us/movies-and-tv"}]},{name:"Devices &amp; Xbox",link:"javascript:void(0)",children:[{name:"All Microsoft devices",link:"https://www.microsoft.com/devices/en-us"},{name:"Microsoft Surface",link:"http://www.microsoft.com/surface/en-us"},{name:"All Windows PCs &amp; tablets",link:"http://www.microsoftstore.com/store/msusa/en_US/cat/Computers/categoryID.62684600"},{name:"PC accessories",link:"https://www.microsoft.com/accessories/en-us"},{name:"Xbox &amp; games",link:"http://www.xbox.com"},{name:"Microsoft Band",link:"http://www.microsoft.com/Microsoft-Band/en-us"},{name:"Microsoft Lumia",link:"http://www.microsoft.com/en-us/mobile/"},{name:"All Windows phones",link:"https://www.microsoft.com/en-us/windows/phones"},{name:"Microsoft HoloLens",link:"http://www.microsoft.com/microsoft-hololens/en-us"}]},{name:"For business",link:"javascript:void(0)",children:[{name:"Cloud Platform",link:"http://www.microsoft.com/en-us/server-cloud/"},{name:"Microsoft Azure",link:"http://azure.microsoft.com/"},{name:"Microsoft Dynamics",link:"http://www.microsoft.com/en-us/dynamics/default.aspx"},{name:"Windows for business",link:"http://www.microsoft.com/en-us/windows/business/default.aspx"},{name:"Office for business",link:"https://products.office.com/en-us/business/office"},{name:"Skype for business",link:"https://products.office.com/en-us/skype-for-business"},{name:"Surface for business",link:"http://www.microsoft.com/surface/en-us/business/overview"},{name:"Enterprise solutions",link:"http://www.microsoft.com/enterprise"},{name:"Small business solutions",link:"http://www.microsoft.com/en-us/business/"},{name:"Find a solutions provider",link:"https://pinpoint.microsoft.com"},{name:"Volume Licensing",link:"https://www.microsoft.com/en-us/licensing/default.aspx"}]},{name:"For developers &amp; IT pros",link:"javascript:void(0)",children:[{name:"Develop Windows apps",link:"https://dev.windows.com/en-us"},{name:"Microsoft Azure",link:"http://azure.microsoft.com/"},{name:"MSDN",link:"http://msdn.microsoft.com/en-us/"},{name:"TechNet",link:"http://technet.microsoft.com/en-us/"},{name:"Visual Studio",link:"http://www.visualstudio.com/"}]},{name:"For students &amp; educators",link:"javascript:void(0)",children:[{name:"Office for students",link:"http://www.microsoft.com/en-us/education/products/office/default.aspx"},{name:"OneNote in classroom",link:"http://www.microsoft.com/en-us/education/products/onenote/default.aspx"},{name:"Shop PCs &amp; tablets perfect for students",link:"http://www.microsoftstore.com/store/msusa/en_US/edu"},{name:"Microsoft in Education",link:"http://www.microsoft.com/en-us/education"}]}]},{name:"Support",link:"https://support.microsoft.com/en-us",children:[]}]}document.addEventListener("DOMContentLoaded",function(){function e(e){for(var o=t(),s=e.target.nextElementSibling,n=e.target.parentElement.parentElement,i=e.target.classList.contains("active"),a=void 0;(a=n.getElementsByClassName("active")).length>0;)a[0].getAttribute("data-height")&&(o?a[0].style.height=a[0].getAttribute("data-height")+"px":a[0].style.height="auto"),a[0].className=a[0].className.replace(" active","");if(i)n.getAttribute("data-height")&&(o?n.style.height=n.getAttribute("data-height")+"px":n.style.height="auto");else if(e.target.className+=" active",s&&(s.className+=" active",o&&s.classList.contains("level3"))){var r=void 0;n.getAttribute("data-height")?r=n.getAttribute("data-height"):(r=n.offsetHeight,n.setAttribute("data-height",r)),r>s.offsetHeight?s.style.height=r+"px":n.style.height=s.offsetHeight+"px"}}function t(){return"absolute"!==window.getComputedStyle(document.getElementById("ms-menu__wrapper")).getPropertyValue("position")}function o(){for(var e=arguments.length<=0||void 0===arguments[0]?-1:arguments[0],t=["together","performance","safe"],o=document.getElementById("db-carousel__paginator"),s=0,n=o.getElementsByClassName("db-carousel__paginator-btn"),i=0;i<n.length;i++)if(n[i].classList.contains("active")){toggleClass(n[i],"active"),s=i;break}e<0&&(e=(s+1)%3),toggleClass(n[e],"active"),document.getElementById("db-carousel__screen").className=document.getElementById("db-carousel__screen").className.replace("--"+t[s],"--"+t[e]);var a=document.getElementById("db-carousel__screen"),r=a.getElementsByClassName("db-carousel__screen-image");toggleClass(r[s],"active"),setTimeout(function(){var t=a.getElementsByClassName("db-carousel__screen-film")[0];t.setAttribute("style","transform: translateX("+100*-e/3+"%)"),toggleClass(r[e],"active")},600);var c=document.getElementById("dp-carousel__text"),m=c.getElementsByClassName("dp-carousel__text-item");toggleClass(m[s],"active"),setTimeout(function(){c.setAttribute("style","transform: translateX("+100*-e/3+"%)"),toggleClass(m[e],"active")},450)}var s=_.template(document.getElementById("ms-header-template").innerHTML,{variable:"data"});document.getElementById("ms-menu__wrapper").insertAdjacentHTML("beforeend",s(getMsMenu())),window.onresize=function(){for(var e=document.getElementById("ms-menu__wrapper"),t=e.getElementsByTagName("*"),o=0,s=void 0;s=t[o++];)s.getAttribute("style")&&(s.removeAttribute("data-height"),s.removeAttribute("style"))},document.getElementById("ms-menu__wrapper").addEventListener("click",function(o){t()?o.target.className.indexOf("ms-menu__item level2 with-submenu")===-1&&e(o):e(o)}),document.getElementById("ms-menu__wrapper").addEventListener("mouseover",function(o){o.target.className.indexOf("ms-menu__item level2 with-submenu")>=0&&t()&&!o.target.classList.contains("active")&&e(o)}),document.getElementById("ms-toggle-search").addEventListener("click",function(e){toggleClass(e.target,"active"),toggleClass(document.getElementById("ms-search-form"),"active")}),document.getElementById("ms-nav__toggle-menu").addEventListener("click",function(e){toggleClass(document.getElementsByTagName("html")[0],"ms-block-content"),toggleClass(e.target,"active"),toggleClass(document.getElementById("ms-menu__wrapper"),"active"),setTimeout(function(){return toggleClass(document.getElementById("ms-menu__wrapper"),"hidden")},300)}),document.getElementById("db-carousel__paginator").addEventListener("click",function(e){if(e.target.classList.contains("db-carousel__paginator-btn")&&!e.target.classList.contains("active")){var t=parseInt(e.target.getAttribute("data-pg"));o(t)}}),document.getElementById("db-carousel__navigation-arrow").addEventListener("click",function(){o()});var n={checkEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,o=e.value.trim();return t.test(o.trim())},checkTextField:function(e){var t=arguments.length<=1||void 0===arguments[1]?6:arguments[1],o=e.value.trim();return o.trim().length>=t},toggleError:function(e,t){t?e.className="":e.className="error"}},i=5,a=6;document.getElementById("registration-form__input--name").addEventListener("keyup",function(e){n.toggleError(e.target,n.checkTextField(e.target,i))}),document.getElementById("registration-form__input--email").addEventListener("keyup",function(e){n.toggleError(e.target,n.checkEmail(e.target,a))}),document.getElementById("registration-form__input--password").addEventListener("keyup",function(e){n.toggleError(e.target,n.checkTextField(e.target))}),document.getElementById("registration-form__input--submit").addEventListener("click",function(e){var t=!0,o=void 0,s=document.getElementById("registration-form__input--name");n.toggleError(s,t=n.checkTextField(s,i)),s=document.getElementById("registration-form__input--email"),n.toggleError(s,o=n.checkEmail(s)),o||(t=!1),s=document.getElementById("registration-form__input--password"),n.toggleError(s,o=n.checkTextField(s,a)),o||(t=!1),t||e.preventDefault()}),document.querySelector("nav.ap-navigation").addEventListener("click",function(e){e.target.classList.contains("ap-navigation__button")&&~window.getComputedStyle(e.target,":after").getPropertyValue("content").indexOf("+")&&toggleClass(e.target,"active")})});