function getUniqueId(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}define("getUniqueId",function(){}),define("todoModel",["getUniqueId"],function(){function t(){var t=this;t.taskList=[];var e=localStorage.getItem("todo_arr");if(e)try{t.taskList=JSON.parse(e)}catch(n){}t.getTaskList=function(){return t.taskList},t.getTask=function(e){return t.taskList.filter(function(t){return t.id===e})[0]},t.createTask=function(e){var n;return e.length>0&&(n={id:getUniqueId(),done:!1,name:e},t.taskList.push(n),localStorage.setItem("todo_arr",JSON.stringify(t.taskList))),n},t.toggleDone=function(e){var n=t.getTask(e);return n&&(n.done=!n.done,localStorage.setItem("todo_arr",JSON.stringify(t.taskList))),n},t.updateTask=function(e,n){var o=t.getTask(e);return o&&(o.name=n,localStorage.setItem("todo_arr",JSON.stringify(t.taskList))),o},t.deleteTask=function(e){var n=t.getTask(e);return n&&(t.taskList.splice(t.taskList.indexOf(n),1),localStorage.setItem("todo_arr",JSON.stringify(t.taskList))),t.taskList}}return t}),function(){var t={};this.tmpl=function e(n,o){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):t[n]=t[n]||e(document.getElementById(n).innerHTML);return o?i(o):i}}(),define("tmpl",function(){}),define("todoView",["todoModel","tmpl"],function(){function t(t){function e(){n.todoBlock=document.getElementById("todo-list"),n.inputField=n.todoBlock.querySelector(".todo-list__input input"),n.taskItems=n.todoBlock.getElementsByTagName("ul")[0],n.template=document.getElementById("todo-item-template").innerHTML,n.renderList()}var n=this;n.model=t,n.renderList=function(){n.taskItems.innerHTML=tmpl(n.template,{data:n.model.getTaskList()})||""},e(),n.renderListElement=function(t){"string"==typeof t&&(t=n.model.getTask(t));var e=document.getElementById(t.id);e?(e.getElementsByTagName("div")[0].className=t.done?"todo-item__done--checked":"todo-item__done",e.querySelector(".todo-item__text > input").value=t.name):n.taskItems.innerHTML+=tmpl(n.template,{data:[t]})},n.toggleEditing=function(t){var e=document.getElementById(t).querySelector(".todo-item__text > input");return e.hasAttribute("disabled")?(e.removeAttribute("disabled"),e.focus()):e.setAttribute("disabled",!0),e}}return t}),define("todoController",["todoModel","todoView"],function(){function t(t,e){function n(e){if(13===e.keyCode){var n=e.target.parentNode.parentNode.id;t.updateTask(n,e.target.value),o.apply(this)}return!1}function o(){this.removeEventListener("keypress",n),this.removeEventListener("focusout",o);var t=this.parentNode.parentNode.id;e.toggleEditing(t),e.renderListElement(t)}e.inputField.addEventListener("keypress",function(n){var o=n.target.value.trim();13==n.keyCode&&o.length>0&&(e.renderListElement(t.createTask(o)),n.target.value="")}),e.taskItems.addEventListener("click",function(i){switch(i.target.className){case"todo-item__done":case"todo-item__done--checked":e.renderListElement(t.toggleDone(i.target.parentNode.id));break;case"todo-item__control--edit":var r=e.toggleEditing(i.target.parentNode.parentNode.id);r.addEventListener("keypress",n),r.addEventListener("focusout",o);break;case"todo-item__control--delete":t.deleteTask(i.target.parentNode.parentNode.id),e.renderList()}})}return t}),requirejs.config({paths:{tmpl:"lib/tmpl",getUniqueId:"lib/getUniqueId"},shim:{tmpl:{deps:[],exports:"tmpl"},getUniqueId:{deps:[],exports:"getUniqueId"}}}),require(["todoModel","todoView","todoController"],function(t,e,n){var o=new t,i=new e(o);new n(o,i)}),define("app",function(){});